@extends('app')
@section('meta')
    <meta name="description" content="Productos para mascotas directo a tu hogar, delivery con conciencia, retiramos lo que reciclas, fomentando la economía circular.">
    <!-- Google / Search Engine Tags -->
    <meta itemprop="name" content="Formulario de Suscripcion - Mundo Crossfire">
    <meta itemprop="description" content="Productos para mascotas directo a tu hogar, delivery con conciencia, retiramos lo que reciclas, fomentando la economía circular.">
    <meta itemprop="image" content="{{asset('storage/meta/iso.png')}}">
    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="www.mundo-crossfire.com.ve">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Formulario de Suscripcion - Mundo Crossfire">
    <meta property="og:description" content="Productos para mascotas directo a tu hogar, delivery con conciencia, retiramos lo que reciclas, fomentando la economía circular.">
    <meta property="og:image" content="{{asset('storage/meta/iso.png')}}">
    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Formulario de Suscripcion - Mundo Crossfire">
    <meta name="twitter:description" content="Productos para mascotas directo a tu hogar, delivery con conciencia, retiramos lo que reciclas, fomentando la economía circular.">
    <meta name="twitter:image" content="{{asset('storage/meta/iso.png')}}">
@endsection
@section('css')
<style>

    .style-mascotas-title{
        width: 65px !important;
    }
    .style-mascotas-title{
        width: 100px !important;
    }
    .style-table-total{
        width: 100% !important;
        text-align: right !important;
        margin-left: auto !important;
    }

    .color-green{
        color: var(--global-primary) !important;
    }
    
    @media (min-width:767px) {
        .style-mascotas-title{
            width: 100px !important;
        }
        .style-mascotas-title{
            width: 150px !important;
        }
        .style-table-total{
            width: 50% !important;
            text-align: right !important;
            margin-left: auto !important;
        }
    }
    input,select{
            background-color: #F5F5F5 !important;
            border-width: 0px 0px 0px 0px !important;
        }
</style>
<link rel="stylesheet" type="text/css" href="{{asset('vendors/css/extensions/sweetalert2.min.css')}}">
<link href="{{ asset('css/style.css') }}" rel="stylesheet" type="text/css">

@endsection
@section('content')
    <div class="ast-container">


        <div id="primary" class="content-area primary">


            <main id="main" class="site-main">
                <article class="post-4427 page type-page status-publish ast-article-single" id="post-4427"
                    itemtype="https://schema.org/CreativeWork" itemscope="itemscope">
                    <header class="entry-header ast-header-without-markup">

                    </header><!-- .entry-header -->

                    <div class="entry-content clear" itemprop="text">


                        <div class="elementor elementor-4427">
                            <div class="elementor-inner">
                                <div class="elementor-section-wrap">
                                    <section
                                        class="elementor-section elementor-top-section elementor-element elementor-element-a584ef8 elementor-section-content-middle elementor-reverse-mobile elementor-section-boxed elementor-section-height-default elementor-section-height-default"
                                        data-id="a584ef8" data-element_type="section">
                                        <form class="elementor-form"  name="New Form" id="form_pay_wapay" action="">
                                        <div ></div>










                                        <div class="elementor-container elementor-column-gap-default">
                                            <div class="elementor-row">
                                                <div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-b7bcb4e"
                                                    data-id="b7bcb4e" data-element_type="column">
                                                    <div class="elementor-column-wrap elementor-element-populated">
                                                        <div class="elementor-row">
                                                            <div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-b6899d4"
                                                                data-id="b6899d4" data-element_type="column">
                                                                <div class="elementor-column-wrap elementor-element-populated">
                                                                    <div class="elementor-widget-wrap">
                                                                        <div class="elementor-element elementor-element-b093c68 elementor-widget elementor-widget-heading"
                                                                            data-id="b093c68" data-element_type="widget"
                                                                            data-widget_type="heading.default">
                                                                            <div class="elementor-widget-container">
                                                                                <h4 style="color:var(--global-primary)"
                                                                                    class="elementor-heading-title elementor-size-default">
                                                                                    Último paso</h4>
                                                                            </div>
                                                                        </div>
                                                                        <div class="elementor-element elementor-element-e3e205c elementor-widget elementor-widget-text-editor"
                                                                            data-id="e3e205c" data-element_type="widget"
                                                                            data-widget_type="text-editor.default">
                                                                            <div class="elementor-widget-container">
                                                                                <div class="elementor-text-editor elementor-clearfix">
                                                                                    <p style="margin-bottom:0px !important">Formulario de suscripción</p>
                                                                                    <p style="color: #D94F4F;">(*) Obligatorio</p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <section class="elementor-section elementor-inner-section elementor-element elementor-element-43360ebe elementor-section-content-middle elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="43360ebe">
                                                                            <div class="elementor-container elementor-column-gap-default">
                                                                                <div class="elementor-row">
                                                                                    <div class="elementor-column elementor-col-100 elementor-inner-column elementor-element elementor-element-e1448d2" data-id="e1448d2">
                                                                                        <div class="elementor-column-wrap elementor-element-populated">
                                                                                            <div class="elementor-widget-wrap">
                                                                                                <div class="elementor-element elementor-element-58a0b0a elementor-button-align-stretch elementor-widget elementor-widget-form" data-id="58a0b0a" data-element_type="widget" data-settings="{&quot;step_next_label&quot;:&quot;Next&quot;,&quot;step_previous_label&quot;:&quot;Previous&quot;,&quot;button_width&quot;:&quot;100&quot;,&quot;step_type&quot;:&quot;number_text&quot;,&quot;step_icon_shape&quot;:&quot;circle&quot;}" data-widget_type="form.default">
                                                                                                    <div class="elementor-widget-container">
                                                                                                        <div class="elementor-form-fields-wrapper elementor-labels-above">

                                                                                                            
                                                                                                            @guest
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="name" class="float-left" >Nombres y Apellidos <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <input  size="1" type="text" style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="name" name="name" class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="email" class="float-left" >Correo Electronico <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <input  size="1" type="email"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="email" name="email" class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="cemail" class="float-left" >Confirmar correo Electronico <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <input  size="1" type="email"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" onchange="validEmail()" id="vemail" class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>
                                                                                                            @endguest

                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="number" class="float-left" >Número de teléfono <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <input  size="1" type="number"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="phone" name="phone"  class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>

                                                                                                            @guest
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="password" class="float-left" >Agrege su clave de usuario <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <p style="width: 100%;margin-bottom:0px;text-align:left;font-size:10px">Esta será su clave para iniciar sesión</p>
                                                                                                                    <div style="width:100%;display:flex">
                                                                                                                        <input  size="1" type="password" style="border: none;border-radius: 0px;border-bottom:1px solid #000"  id="password" name="password" class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                        <div style="position:absolute;right:0px;top:50px" onclick="viewPassword()">
                                                                                                                            <i id="eye-password" class="far fa-eye color-green"></i>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    
                                                                                                                </div>
                                                                                                                {{-- <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="nac" class="float-left" >Fecha de Nacimiento <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <input  size="1" type="date"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="fecha_nacimiento" name="fecha_nacimiento" class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div> --}}
                                                                                                                
                                                                                                            @endguest

                                                                                                            


                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="reg" class="float-left" >Región <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <input disabled size="1" type="text"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="region" name="region" value="Región Metropolitana" placeholder="- Región Metropolitana -" class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="com" class="float-left" >Comuna <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <select name="comuna" id="comuna" onchange="changeDiasSemanas()" style="width: 100%;border: none;border-radius: 0px;border-bottom:1px solid #000">
                                                                                                                        <option value="" >Seleccione una comuna</option>
                                                                                                                        <option value="La Reina" >La Reina</option>
                                                                                                                        <option value="Ñuñoa" >Ñuñoa</option>
                                                                                                                        <option value="Peñalolen" >Peñalolen</option>
                                                                                                                        <option value="San Bernardo" >San Bernardo</option>
                                                                                                                        <option value="San Miguel" >San Miguel</option>
                                                                                                                    </select>
                                                                                                                </div>
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="calle" class="float-left" >Calle o avenida <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <input  size="1" type="text"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="calle_avenida" name="calle_avenida" class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>


                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="number" class="float-left" >Número <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <input  size="1" type="number"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="numero" name="numero"  class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>




                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="number" class="float-left" >N° Depto / Casa</label>
                                                                                                                    <input  size="1" type="text"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="nrocasa" name="nrocasa"  class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="number" class="float-left" >Referencia</label>
                                                                                                                    <input  size="1" type="text"  style="border: none;border-radius: 0px;border-bottom:1px solid #000" id="referencia" name="referencia"  class="elementor-field elementor-size-sm  elementor-field-textual">
                                                                                                                </div>
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="semana" class="float-left" style="margin-bottom:10px;width:100%" >Tiene mascotas?</label>
                                                                                                                    <ul style="margin-left:0px;margin-bottom:0px">
                                                                                                                        <li class="list-group-item" style="list-style:none;float: left;margin-left:10px">
                                                                                                                          <div class="custom-control custom-checkbox">
                                                                                                                            <input  type="radio" disabled class="custom-control-input"  onclick="mascotasFN('si')" name="mascotas-si-no" id="mascotas-si">
                                                                                                                            <label class="custom-control-label" for="check-sem-1">Si</label>
                                                                                                                          </div>
                                                                                                                        </li>
                                                                                                                        <li class="list-group-item" style="list-style:none;float: left;margin-left:10px">
                                                                                                                          <div class="custom-control custom-checkbox">
                                                                                                                            <input type="radio" disabled class="custom-control-input" onclick="mascotasFN('no')" checked name="mascotas-si-no" id="mascotas-no">
                                                                                                                            <label class="custom-control-label" for="check-sem-2">No</label>
                                                                                                                          </div>
                                                                                                                        </li>
                                                                                                                    </ul>
                                                                                                                </div>

                                                                                                                <div id="mascotas-html" class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                </div>
                                                                                                            


                                                                                                            












                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="sem" class="float-left" >Seleccione el día de la semana que desea el despacho y retiro de residuos, este será el día que lo visitaremos según las semanas que seleccione. <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                    <select id="dia_visita" name="dia_visita" style="width: 100%;border: none;border-radius: 0px;border-bottom:1px solid #000">
                                                                                                                        <option selected disabled >Seleccione una comuna</option>
                                                                                                                    </select>
                                                                                                                </div>
                                                                                                                <div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-name elementor-col-100" style="margin-bottom:15px">
                                                                                                                    <label for="semana" class="float-left" style="margin-bottom:10px" >Seleccione <span id="text-semanas"></span> según el plan elegido para el despacho y retiro de residuos, estas serán las semanas de visitas por mes durante el tiempo de suscripción. <i style="font-size: 15px;font-weight: bold;color: #D94F4F;" >*</i></label>
                                                                                                                   


                                                                                                                    <ul style="margin-left:0px;margin-bottom:0px">
                                                                                                                        <li class="list-group-item" style="list-style:none">
                                                                                                                          <div class="custom-control custom-checkbox">
                                                                                                                            <input  type="checkbox" disabled class="custom-control-input" name="semana_visita" value="Semana 1" onchange="checkSemana('Semana 1')" id="check-sem-1">
                                                                                                                            <label class="custom-control-label" for="check-sem-1">Semana 1</label>
                                                                                                                          </div>
                                                                                                                        </li>
                                                                                                                        <li class="list-group-item" style="list-style:none">
                                                                                                                          <div class="custom-control custom-checkbox">
                                                                                                                            <input type="checkbox" disabled class="custom-control-input" name="semana_visita" value="Semana 2" onchange="checkSemana('Semana 2')" id="check-sem-2">
                                                                                                                            <label class="custom-control-label" for="check-sem-2">Semana 2</label>
                                                                                                                          </div>
                                                                                                                        </li>
                                                                                                                        <li class="list-group-item" style="list-style:none">
                                                                                                                          <div class="custom-control custom-checkbox">
                                                                                                                            <input type="checkbox" disabled class="custom-control-input" name="semana_visita" value="Semana 3" onchange="checkSemana('Semana 3')" id="check-sem-3" >
                                                                                                                            <label class="custom-control-label" for="check-sem-3">Semana 3</label>
                                                                                                                          </div>
                                                                                                                        </li>
                                                                                                                        <li class="list-group-item" style="list-style:none">
                                                                                                                          <div class="custom-control custom-checkbox">
                                                                                                                            <input type="checkbox" disabled class="custom-control-input" name="semana_visita" value="Semana 4" onchange="checkSemana('Semana 4')" id="check-sem-4" >
                                                                                                                            <label class="custom-control-label" for="check-sem-4">Semana 4</label>
                                                                                                                          </div>
                                                                                                                        </li>
                                                                                                                        <li class="list-group-item" style="list-style:none">
                                                                                                                          <div class="custom-control custom-checkbox">
                                                                                                                            <input type="checkbox" disabled class="custom-control-input" name="semana_visita" value="Ultima semana" onchange="checkSemana('Ultima semana')" id="check-sem-5">
                                                                                                                            <label class="custom-control-label" for="check-sem-5">Última semana</label>
                                                                                                                          </div>
                                                                                                                        </li>
                                                                                                                      </ul>
                                                                                                                      <input type="text" style="visibility: hidden" class="custom-control-input" name="paquete_id" id="paquete_id" >
                                                                                                                      <input type="text" style="visibility: hidden" class="custom-control-input" name="kit_id"  id="kit_id">
                                                                                                                </div>
                                                                                                            </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </section>
                                                                        @guest
                                                                            <div id="finish-msg-register" style="margin: 15px auto;background-color:#f2f2f2;padding:10px;font-size:20px">
                                                                                <p style="margin-bottom: 0px">!!Felicidades!!, te has registrado exitosamente en Mundo Crossfire, te hemos enviado un email de confirmacion.</p>
                                                                                <p style="margin-bottom: 0px">A partir de ahora puedes entrar como usuario con tu correo y tu clave secreta.</p>
                                                                            </div>
                                                                        @endguest
                                                                        <div style="margin: 20px auto" class="elementor-element elementor-element-e3e205c elementor-widget elementor-widget-text-editor" data-id="e3e205c" data-element_type="widget" data-widget_type="text-editor.default">
                                                                            <div class="elementor-widget-container">
                                                                                <div  class="elementor-text-editor elementor-clearfix">
                                                                                    <p id="total-suscribe-form" ></p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        

                                                                    {{-- <form action="" id="form_pay_wapay"> --}}
                                                                        <div class="elementor-element elementor-element-6eab4b7 elementor-align-center elementor-mobile-align-center elementor-tablet-align-center elementor-widget elementor-widget-button"
                                                                            data-id="6eab4b7" data-element_type="widget"
                                                                            data-widget_type="button.default">
                                                                            <div class="elementor-widget-container">
                                                                                <div class="elementor-button-wrapper">
                                                                                    {{csrf_field()}} 
                                                                                        <input type="hidden" name="token_ws" value="" id="token_ws">
                                                                                            
                                                                                            @auth
                                                                                                <button type="buttom" class="checkout-button button alt wc-forward" style="cursor:pointer" id="confirm-pay" onclick="alert('auth',event)">
                                                                                                    Continuar
                                                                                                </button>
                                                                                            @endauth

                                                                                            @guest
                                                                                                <button type="buttom" class="checkout-button button alt wc-forward" style="cursor:pointer" id="confirm-pay" onclick="alert('guest',event)">
                                                                                                    Continuar
                                                                                                </button>
                                                                                            @endguest

                                                                                        <div  class="lds-ellipsis" id="load"><div></div><div></div><div></div><div></div></div>

                                                                                        
                                                                                        
                                                                                        
                                                                                        <button type="submit" class="checkout-button button alt wc-forward" id="finish-pay">Pagar 
                                                                                        </button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    {{-- </form> --}}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    </section>
                                    
                                  
                                </div>
                            </div>
                        </div>



                    </div><!-- .entry-content .clear -->



                </article><!-- #post-## -->

            </main><!-- #main -->


        </div><!-- #primary -->


    </div> <!-- ast-container -->
@endsection
@section('js')
<script src="{{asset('vendors/js/extensions/sweetalert2.all.min.js')}}"></script>
    <script src="{{asset('vendors/js/extensions/polyfill.min.js')}}"></script>
<script>
        $(document).ready(function() {
            $('#finish-pay').hide()
            $('#finish-msg-register').hide()
            $('#load').hide()
            mascotasFN('no')
            $('#check-sem-1').prop("disabled",false)
            $('#check-sem-2').prop("disabled",false)
            $('#check-sem-3').prop("disabled",false)
            $('#check-sem-4').prop("disabled",false)
            $('#check-sem-5').prop("disabled",false)
        });
</script>
<script>
    let mascotasArr = [{id: 1, state:0,titulo:'Perro',cantidad:0,tipo:''},{id: 2, state:0,titulo:'Gato',cantidad:0,tipo:''},{id: 3, state:0,titulo:'Otro',cantidad:0,tipo:''}]
    let newMascotasArr = []
    let mascotas_si_no = "No"
    let mascotasEACHValid = true
    let plan_suscribe = JSON.parse(localStorage.getItem("plan_suscribe"))
    let total = plan_suscribe.kits + plan_suscribe.price
    let arrSemana = []
    let payload = {}
    $('#paquete_id').val(plan_suscribe.paquete_id)
    $('#kit_id').val(plan_suscribe.kit_id)
    $('#total-suscribe-form').empty().append(`Total $ ${formatCurrency(JSON.parse(total))}`)
    //checkSemana('Semana 1')
    
    changeDiasSemanas('El Bosque')


    if(plan_suscribe.paqueteName.toLowerCase() === 'plan 15'){
        $('#text-semanas').empty().append('2 Semanas')
    }
    if(plan_suscribe.paqueteName.toLowerCase() === 'plan 30'){
        $('#text-semanas').empty().append('1 Semana')
    }

    function formatCurrency (number) {
        return new Intl.NumberFormat('de-DE', {
            currency: 'USD',
            minimumFractionDigits: 0
        }).format(number);
    }
    function viewPassword() {
        if($('#password').is(":password")){
            $('#password').prop('type','text')
            $('#eye-password').removeClass('far').removeClass('fa-eye').addClass('fas').addClass('fa-eye-slash').removeClass('color-green')
        }else{
            $('#password').prop('type','password')
            $('#eye-password').removeClass('fas').removeClass('fa-eye-slash').addClass('far').addClass('fa-eye').addClass('color-green')
        }
    }
    function validEmail() {
        if($('#email').val() !== $('#vemail').val() ){
            Swal.fire({
                title: "Alerta!",
                text: "Los correos no coinciden!",
                type: "info",
                timer: 3000,
                confirmButtonClass: 'btn btn-primary',
                buttonsStyling: false,
            });
            $('#vemail').val('')
        }
    }

    function checkMascotas(params,id) {

        if($(`#mascotasArr-${id}`).is(":checked")){
            $(`#mascotasArr-${id}`).prop( "checked",true);
            $(`#mascotasArr-cantidad-${id}`).prop("disabled",false)
            $(`#mascotasArr-tipo-${id}`).prop("disabled",false)
            mascotasArr[params].state = 1
        }else{
            $(`#mascotasArr-${id}`).prop( "checked",false);
            $(`#mascotasArr-cantidad-${id}`).prop("disabled",true)
            $(`#mascotasArr-tipo-${id}`).prop("disabled",true)
            mascotasArr[params].state = 0
            
        }
    }
    function mascotasEACH() {
        mascotasEACHValid = true
        newMascotasArr = mascotasArr.filter(i => (i.state === 1))
        newMascotasArr.forEach( (element, index) => {
            if( parseInt($(`#mascotasArr-cantidad-${element.id}`).val()) >= 1){
                newMascotasArr[index].cantidad =  parseInt($(`#mascotasArr-cantidad-${element.id}`).val())
                newMascotasArr[index].tipo =  $(`#mascotasArr-tipo-${element.id}`).val()
            }else{
                mascotasEACHValid = false
                return 0
            }
                
        });
    }
    function mascotasAdd() {
        mascotasArr.push({id: mascotasArr[mascotasArr.length - 1].id + 1, state:0,titulo:'Otro',cantidad:0,tipo:''})
        let html= `<li class="list-group-item" style="list-style:none;display:flex;margin: 5px auto">
                            <div class="custom-control custom-checkbox style-mascotas-title" style="margin: auto;" >
                                <input  type="checkbox" class="custom-control-input" name="mascotasArr" onchange="checkMascotas(${mascotasArr.length - 1},${mascotasArr[mascotasArr.length - 1].id})" id="mascotasArr-${mascotasArr[mascotasArr.length - 1].id}">
                                <label class="custom-control-label" for="check-sem-1"> ${mascotasArr[mascotasArr.length - 1].titulo} </label>
                            </div>
                            <input style="margin:auto 5px"  type="number"  class="custom-control-input style-mascotas-title"  placeholder="Cantidad" disabled id="mascotasArr-cantidad-${mascotasArr[mascotasArr.length - 1].id}">
                            <input style="width:60%;margin:auto 5px"  type="text" class="custom-control-input" value="${mascotasArr[mascotasArr.length - 1].tipo}" disabled placeholder="Tipo" id="mascotasArr-tipo-${mascotasArr[mascotasArr.length - 1].id}">
                        </li>`;
        $('#ul-list-mascotas').append(html)
      
    }
    function mascotasFN(params) {
        let html = ``
        html = `<ul id="ul-list-mascotas" style="margin-left:0px;margin-bottom:0px">`;
            mascotasArr.forEach((element, index ) => {
                html+=`<li  class="list-group-item" style="list-style:none;display:flex;margin: 5px auto">
                            <div class="custom-control custom-checkbox style-mascotas-title" style="margin: auto;" >
                                <input  type="checkbox"  class="custom-control-input" name="mascotasArr" onchange="checkMascotas(${index},${element.id})" id="mascotasArr-${element.id}">
                                <label class="custom-control-label" for="check-sem-1"> ${element.titulo} </label>
                            </div>
                            <input style="margin:auto 5px"  type="number"  class="custom-control-input style-mascotas-title"  placeholder="Cantidad" disabled id="mascotasArr-cantidad-${element.id}">
                            <input style="width:60%;margin:auto 5px"  type="text" class="custom-control-input" value="${element.tipo}" placeholder="Tipo" disabled id="mascotasArr-tipo-${element.id}">
                        </li>`;
            });
        html+=`</ul>`;
        html += `<div style="width:100%" ><button style="margin-top:5px" type="button" onclick="mascotasAdd()">Agregar otra mascota</button></div>
            
        `;
        if(params === 'si'){
            
            $('#mascotas-html').empty().append(html)
            $(`#mascotasArr-tipo-1`).css('visibility','hidden')
            $(`#mascotasArr-tipo-2`).css('visibility','hidden')
            mascotas_si_no = "Si"
        }
        if(params === 'no'){
            $('#mascotas-html').empty()
            //mascotasArr = []
            mascotas_si_no = "No"
        }
    }
    function checkSemana(params) {
        let validator = arrSemana.find( i => i === params ) 
        let index = arrSemana.findIndex( i => i === params ) 
        if(validator){
            arrSemana.splice(index,1)
        }else{
            arrSemana.push(params)
        }

        if(plan_suscribe.paqueteName.toLowerCase() === 'plan 15'){
            if(arrSemana.length >= 2){
                $('#check-sem-1').prop('disabled',true)  
                $('#check-sem-2').prop('disabled',true)  
                $('#check-sem-3').prop('disabled',true)  
                $('#check-sem-4').prop('disabled',true)  
                $('#check-sem-5').prop('disabled',true)  
            }else{
                $('#check-sem-1').prop('disabled',false)  
                $('#check-sem-2').prop('disabled',false)  
                $('#check-sem-3').prop('disabled',false)  
                $('#check-sem-4').prop('disabled',false)  
                $('#check-sem-5').prop('disabled',false) 
            }
        }
        if(plan_suscribe.paqueteName.toLowerCase() === 'plan 30'){
            if(arrSemana.length >= 1){
                $('#check-sem-1').prop('disabled',true)  
                $('#check-sem-2').prop('disabled',true)  
                $('#check-sem-3').prop('disabled',true)  
                $('#check-sem-4').prop('disabled',true)  
                $('#check-sem-5').prop('disabled',true) 
            }else{
                $('#check-sem-1').prop('disabled',false)  
                $('#check-sem-2').prop('disabled',false)  
                $('#check-sem-3').prop('disabled',false)  
                $('#check-sem-4').prop('disabled',false)  
                $('#check-sem-5').prop('disabled',false) 
            }
        }
        arrSemana.forEach(element => {
            if( element === $("#check-sem-1").val() ){
                $('#check-sem-1').prop('disabled',false)
            }
            if( element === $("#check-sem-2").val() ){
                $('#check-sem-2').prop('disabled',false)
            }
            if( element === $("#check-sem-3").val() ){
                $('#check-sem-3').prop('disabled',false)
            }
            if( element === $("#check-sem-4").val() ){
                $('#check-sem-4').prop('disabled',false)
            }
            if( element === $("#check-sem-5").val() ){
                $('#check-sem-5').prop('disabled',false)
            } 
        });
    }
    function changeDiasSemanas(params) {
        let comuna = $('#comuna').val()
        
        let options04 = `<option value="Viernes" >Viernes</option>`;



        let options05 = `<option value="Martes" >Martes</option>
                         <option value="Jueves" >Jueves</option>`;


        let options06 = `<option value="Lunes" >Lunes</option>
                         <option value="Miercoles" >Miercoles</option>
                         <option value="Viernes" >Viernes</option>`;


        switch (comuna) {
            
            case 'San Bernardo':
                $('#dia_visita').empty().append(options04)
                break;

            case 'San Miguel':
                $('#dia_visita').empty().append(options05)
                break;

            case 'Ñuñoa':
                $('#dia_visita').empty().append(options05)
                break;

            case 'Peñalolen':
                $('#dia_visita').empty().append(options06)
                break;
                
            case 'La Reina':
                $('#dia_visita').empty().append(options06)
                break;
        }
    }
    function modalCloseHistory() {
        $('#load').hide()
        $('.ast-quick-view-bg').removeClass('ast-quick-view-bg-ready')
        $('#ast-quick-view-modal').removeClass('open stick-add-to-cart')
    }
    function modalConfirm(params,user) {
        let html = ``
       
        if(window.screen.width >= 767 ){
                    html += `<div class="ast-content-main-wrapper">
                                    <div class="ast-content-main">
                                        <div class="ast-lightbox-content">
                                            <div class="ast-content-main-head">
                                                <a onclick="modalCloseHistory()" id="ast-quick-view-close" class="ast-quick-view-close-btn"></a>
                                            </div>
                                            <div id="ast-quick-view-content" class="woocommerce single-product" style="max-width: 982px; max-height: 673px;min-width:500px;min-height:300px">
                                                <div class="ast-woo-product">
                                                    <div id="product-245" class="product post-245 type-product status-publish has-post-thumbnail product_cat-alimentos-para-mascotas ast-article-single ast-woo-product-no-review align-center box-shadow-1 box-shadow-3-hover ast-product-gallery-layout-horizontal ast-product-gallery-with-no-image ast-product-tabs-layout-horizontal ast-qv-on-image first instock featured shipping-taxable purchasable product-type-simple">
                                                        <div class="summary entry-summary" style="width:100%;height:600px">
                                                            <div class="summary-content">`;
                }

                
                html += `<article class="post-97 page type-page status-publish ast-article-single"`; if(window.screen.width >= 767 ){ html += `style="padding:0px !important"` } html += `>`;
                                                                if(window.screen.width <= 767 ){ 
                                                                    html += `<div class="ast-content-main-head">
                                                <a onclick="modalCloseHistory()" style="right: 15px;top: 22px;" id="ast-quick-view-close" class="ast-quick-view-close-btn"></a>
                                            </div>` 
                                                                }
                                                                html += `<header class="entry-header ast-no-thumbnail ast-no-meta">
                                                                    <h1 style="text-align:center" class="entry-title" itemprop="headline">Resumen de compra</h1>	
                                                                </header>
                                                                <div class="entry-content clear" itemprop="text">    
                                                                    <div class="woocommerce">
                                                                        <div class="woocommerce-notices-wrapper"></div>
                                                                        <form class="woocommerce-cart-form"  >`;

                                                                            if(user === 'guest'){
                                                                                html += `
                                                                                <table class=" woocommerce-cart-form__contents" style="margin-bottom:0px" cellspacing="0">
                                                                                    <thead>
                                                                                        <tr>
                                                                                            <th colspan="4" style="border-bottom: none;text-align: center" style="text-align: center" class="product-thumbnail"> Datos Personales</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                </table>
                                                                                <table  class="shop_table shop_table_responsive cart woocommerce-cart-form__contents" cellspacing="0">
                                                                                    <thead>
                                                                                        <tr>
                                                                                            <th scope="col">Nombres y Apellidos</th>
                                                                                            <th scope="col">Email</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <tbody id="lista-suscripcion">
                                                                                        <tr class="woocommerce-cart-form__cart-item cart_item">
                                                                                            <td data-title="Nombre" > ${params.name} </td>
                                                                                            <td data-title="Email" > ${params.email} </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                                `;
                                                                            }

                                                                            


                                                                            html += `<table class=" woocommerce-cart-form__contents" style="margin-bottom:0px" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th colspan="4" style="border-bottom: none;text-align: center" style="text-align: center" class="product-thumbnail"> Ubicacion</th>
                                                                                    </tr>
                                                                                </thead>
                                                                            </table>
                                                                            <table  class="shop_table shop_table_responsive cart woocommerce-cart-form__contents" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th scope="col">Región</th>
                                                                                        <th scope="col">Comuna</th>
                                                                                        <th scope="col">Calle o avenida</th>
                                                                                        <th scope="col">Número de teléfono</th>
                                                                                        <th scope="col">N° Depto / Casa</th>
                                                                                        <th scope="col">Número</th>
                                                                                        <th scope="col">Referencia</th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody id="lista-suscripcion">
                                                                                    <tr class="woocommerce-cart-form__cart-item cart_item">
                                                                                        <td data-title="Región"  > ${params.region} </td>
                                                                                        <td data-title="Comuna" > ${params.comuna} </td>
                                                                                        <td data-title="Calle o avenida" > ${params.calle_avenida} </td>
                                                                                        <td data-title="Número de teléfono"  > ${params.phone} </td>
                                                                                        <td data-title="N° Depto / Casa" > ${params.nrocasa} </td>
                                                                                        <td data-title="Número" > ${params.numero} </td>
                                                                                        <td data-title="Referencia" > ${params.referencia} </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                            <table class=" woocommerce-cart-form__contents" style="margin-bottom:0px" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th colspan="4" style="border-bottom: none;text-align: center" style="text-align: center" class="product-thumbnail"> Suscripcion</th>
                                                                                    </tr>
                                                                                </thead>
                                                                            </table>
                                                                            <table  class="shop_table shop_table_responsive cart woocommerce-cart-form__contents" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th  scope="col">Plan</th>
                                                                                        <th scope="col">Tiempo</th>
                                                                                        <th scope="col">Dia de visita</th>
                                                                                        <th scope="col">Semana_de visita</th>
                                                                                        <th scope="col">Total</th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody id="lista-suscripcion">
                                                                                    <tr class="woocommerce-cart-form__cart-item cart_item">
                                                                                        <td data-title="Plan"  > ${params.paqueteName}</td>
                                                                                        <td data-title="Tiempo" >  ${params.tiempo} Meses </td>
                                                                                        <td data-title="Dia de visita" > ${params.dia_visita} </td>
                                                                                        <td data-title="Semana_de visita" > ${params.semana_visita} </td>
                                                                                        <td data-title="Total" >$ ${ formatCurrency(JSON.parse(params.totalpaquete)) } </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                            <table class=" woocommerce-cart-form__contents" style="margin-bottom:0px" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th colspan="4" style="border-bottom: none;text-align: center" style="text-align: center" class="product-thumbnail"> Extensiones</th>
                                                                                    </tr>
                                                                                </thead>
                                                                            </table>
                                                                            <table  class="shop_table shop_table_responsive cart woocommerce-cart-form__contents" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th scope="col">Nombre</th>
                                                                                        <th scope="col">Descripcion</th>
                                                                                        <th scope="col">Precio</th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody id="lista-suscripcion">`;
                                                                                        params.kits.forEach(element => {
                                                                                            html += `<tr class="woocommerce-cart-form__cart-item cart_item">
                                                                                                        <td  data-title="Nombre" > ${element.nombre_kit} </td>
                                                                                                        <td  data-title="Descripcion" > ${element.descripcion_kit} </td>
                                                                                                        <td  data-title="Precio" >$ ${ formatCurrency(JSON.parse(element.precio)) } </td>
                                                                                                    </tr>`;
                                                                                        });
                                                                        html += `</tbody>
                                                                        </table>`;

                                                                        if(params.mascota_si_no === 'Si'){
                                                                            html += `
                                                                            <table class=" woocommerce-cart-form__contents" style="margin-bottom:0px" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th colspan="4" style="border-bottom: none;text-align: center" style="text-align: center" class="product-thumbnail"> Mascotas</th>
                                                                                    </tr>
                                                                                </thead>
                                                                            </table>
                                                                            <table  class="shop_table shop_table_responsive cart woocommerce-cart-form__contents" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th scope="col">Titulo</th>
                                                                                        <th scope="col">Cantidad</th>
                                                                                        <th scope="col">Tipo</th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody id="lista-suscripcion">`;
                                                                                    params.mascotas.forEach(element => {
                                                                                            html += `<tr class="woocommerce-cart-form__cart-item cart_item">
                                                                                                        <td data-title="Titulo" > ${element.titulo} </td>
                                                                                                        <td data-title="Cantidad" >${element.cantidad} </td>
                                                                                                        <td data-title="Tipo" >${element.tipo} </td>
                                                                                                    </tr>`;
                                                                                        });
                                                                                html += `</tbody>
                                                                            </table>
                                                                            `;
                                                                        }

                                                                        html += `
                                                                            <table  class="shop_table shop_table_responsive cart woocommerce-cart-form__contents style-table-total" cellspacing="0">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th style="text-align:right" colspan="4" scope="col">Total</th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody id="lista-suscripcion">
                                                                                    <tr class="woocommerce-cart-form__cart-item cart_item">
                                                                                        <td style="text-align:right" colspan="4" data-title="Total" >$ ${ formatCurrency(JSON.parse(params.total)) } </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                        <div style="margin:20px" class="elementor-element elementor-element-6eab4b7 elementor-align-center elementor-mobile-align-center elementor-tablet-align-center elementor-widget elementor-widget-button" data-id="6eab4b7" data-element_type="widget" data-widget_type="button.default">
                                                                            <div class="elementor-widget-container">
                                                                                <div class="elementor-button-wrapper" style="text-align:right">
                                                                                    <input type="hidden" name="token_ws" value="" id="token_ws">
                                                                                    <a style="margin-bottom:10px" class="checkout-button button alt wc-forward" id="confirm-pay" onclick="modalCloseHistory()">
                                                                                        Regresar
                                                                                    </a>`
                                                    if(user === 'guest'){ html += ` <a class="checkout-button button alt wc-forward" id="confirm-pay"  onclick="pagar()">
                                                                                        Confirmar y Registrarme
                                                                                    </a>
                                                            `}else{html += `        <a class="checkout-button button alt wc-forward" id="confirm-pay"  onclick="pagar()">
                                                                                            Confirmar
                                                                                    </a>`}
                                                                    html += `   </div>
                                                                            </div>
                                                                        </div>
                                                                        </form>
                                                                    </div>        
                                                                </div>        
                                                            </article>`;
                if(window.screen.width >= 767 ){
                    html += `                           </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>`
                }
                            
                $('#ast-quick-view-modal').empty().append(html)
                 
                if(window.screen.width <= 767 ){
                    $('.ast-quick-view-loader').removeClass('ast-quick-view-loader')
                    $('#ast-quick-view-modal').css('background','#fff')
                }
                $('.ast-quick-view-bg').addClass('ast-quick-view-bg-ready')
                $('#ast-quick-view-modal').addClass('open stick-add-to-cart')
    }
    function pagar() {
        $('#confirm-pay').hide()
        
        modalCloseHistory()
        $('#load').show()
            $.ajax({
                type: "POST",
                url: "/crear-cliente-suscripcion",
                data: {
                    "_token": "{{ csrf_token() }}",
                    "payload":payload
                },
                success: function (data) {
                    $('#token_ws').val(data.response.token);
                    $('#form_pay_wapay').attr("action", data.response.url);
                    $('#load').hide()
                    $('#finish-pay').show()
                    $('#finish-msg-register').show()
                    window.location.assign('#colophon')
                },
                error: function (data) {
                    modalCloseHistory()
                    $('#finish-msg-register').hide()
                    $('#load').hide()
                    $('#confirm-pay').show()
                    if(data.responseJSON.error !== ""){
                        Swal.fire({
                            title: "Error",
                            text: data.responseJSON.error,
                            type: "info",
                            timer: 10000,
                            confirmButtonClass: 'btn btn-primary',
                            buttonsStyling: false,
                        });
                    }else{
                        Swal.fire({
                            title: "Error!",
                            text: data.statusText,
                            type: "error",
                            timer: 3000,
                            confirmButtonClass: 'btn btn-primary',
                            buttonsStyling: false,
                        });
                    }
                    
                }
            });
    }
    function alert(params,e) {
        
        mascotasEACH()
        validEmail()
        $('#load').show()
        payload = {}
        let validator = false

        if(arrSemana.length === 0){
            Swal.fire({
                title: "Alerta!",
                text: "Seleccione las semanas segun el plan elegido!",
                type: "info",
                timer: 3000,
                confirmButtonClass: 'btn btn-primary',
                buttonsStyling: false,
            });
            e.preventDefault();
        }



            
            if(params === 'auth'){
                payload = {
                    _token: "{{ csrf_token() }}",
                    region: $('#region').val(),
                    comuna: $('#comuna').val(),
                    calle_avenida: $('#calle_avenida').val(),
                    numero: $('#numero').val(),
                    phone: $('#phone').val(),
                    dia_visita: $('#dia_visita').val(),
                    semana_visita: arrSemana,
                    paquete_id: $('#paquete_id').val(),
                    kit_id: $('#kit_id').val(),
                    paqueteName: plan_suscribe.paqueteName,
                    kits: plan_suscribe.kitsTotal,
                    tiempo: plan_suscribe.time,
                    total: plan_suscribe.kits + plan_suscribe.price,
                    totalpaquete: plan_suscribe.price,
                    nrocasa: $('#nrocasa').val(),
                    referencia: $('#referencia').val(),
                    mascota_si_no : mascotas_si_no,
                    mascotas: newMascotasArr
                }
                validator = (   payload.name === '' ||
                                payload.region === '' || 
                                payload.comuna === '' || 
                                payload.calle_avenida === '' || 
                                payload.numero === '' || 
                                payload.phone === '' || 
                                payload.dia_visita === '' || 
                                payload.semana_visita.length === 0  || 
                                payload.paquete_id === '' || 
                                payload.kit_id === '' ) ? false : true
            }

            if(params === 'guest'){
                payload = {
                    _token: "{{ csrf_token() }}",
                    name: $('#name').val(),
                    password: $('#password').val(),
                    email: $('#email').val(),
                    region: $('#region').val(),
                    comuna: $('#comuna').val(),
                    calle_avenida: $('#calle_avenida').val(),
                    numero: $('#numero').val(),
                    phone: $('#phone').val(),
                    nrocasa: $('#nrocasa').val(),
                    referencia: $('#referencia').val(),
                    totalpaquete: plan_suscribe.price,
                    dia_visita: $('#dia_visita').val(),
                    semana_visita: arrSemana,
                    paquete_id: $('#paquete_id').val(),
                    kit_id: $('#kit_id').val(),
                    paqueteName: plan_suscribe.paqueteName,
                    kits: plan_suscribe.kitsTotal,
                    tiempo: plan_suscribe.time,
                    total: plan_suscribe.kits + plan_suscribe.price,
                    mascota_si_no : mascotas_si_no,
                    mascotas: newMascotasArr
                }

                validator = (   payload.name === '' || 
                                payload.password === '' || 
                                payload.email === '' || 
                                payload.region === '' || 
                                payload.comuna === '' || 
                                payload.calle_avenida === '' || 
                                payload.numero === '' || 
                                payload.phone === '' || 
                                payload.dia_visita === '' || 
                                payload.semana_visita.length === 0  || 
                                payload.paquete_id === '' || 
                                payload.kit_id === '' ) ? false : true
            }
            if(validator && mascotasEACHValid){
                e.preventDefault();
                modalConfirm(payload,params)
            }else{
                $('#load').hide()
                if(payload.name === ''){
                    $('#name').prop("required", true)
                    $("#name").attr("placeholder", "Escribe aqui tu nombre y apellido").val("").focus().blur();
                    $("#name").css("border-color", "red")
                }else{ $("#name").css("border-color", "black")  }

                if(payload.email === ''){
                    $('#email').prop("required", true)
                    $("#email").attr("placeholder", "ejemplo@tucorreo.com").val("").focus().blur();
                    $("#email").css("border-color", "red")
                }else{ $("#email").css("border-color", "black")  }

                if(payload.phone === ''){
                    $('#phone').prop("required", true)
                    $("#phone").attr("placeholder", "Solo ingresar numeros").val("").focus().blur();
                    $("#phone").css("border-color", "red")
                }else{ $("#phone").css("border-color", "black")  }

                if(payload.password === ''){
                    $('#password').prop("required", true)
                    $("#password").attr("placeholder", "Ingrese su clave de usuario").val("").focus().blur();
                    $("#password").css("border-color", "red")
                }else{ $("#password").css("border-color", "black")  }

                if(payload.comuna === ""){
                    $('#comuna').prop("required", true)
                    $("#comuna").focus().val("").blur();
                    $("#comuna").css("border-color", "red")
                }else{ $("#comuna").css("border-color", "black")  }

                if(payload.dia_visita === null || payload.dia_visita === "" ){
                    $('#dia_visita').prop("required", true)
                    $("#dia_visita").focus().blur();
                    $("#dia_visita").css("border-color", "red")
                }else{ $("#dia_visita").css("border-color", "black")  }

                if(payload.calle_avenida === ''){
                    $('#calle_avenida').prop("required", true)
                    $("#calle_avenida").attr("placeholder", "Ingrese una calle o avenida").val("").focus().blur();
                    $("#calle_avenida").css("border-color", "red")
                }else{ $("#calle_avenida").css("border-color", "black")  }

                if(payload.numero === ''){
                    $('#numero').prop("required", true)
                    $("#numero").attr("placeholder", "Ingrese un numero").val("").focus().blur();
                    $("#numero").css("border-color", "red")
                }else{ $("#numero").css("border-color", "black")  }

                if(!mascotasEACHValid){
                    e.preventDefault();
                    Swal.fire({
                        title: "Alerta!",
                        text: "Ingrese cantidad de mascotas!",
                        type: "info",
                        timer: 10000,
                        confirmButtonClass: 'btn btn-primary',
                        buttonsStyling: false,
                    });
                    
                }
            }
        


    }

    $('input:checkbox').prop("disabled",false)
    $('input:radio').prop("disabled",false)
</script>

<script>
    function EnviarCompra(){
        $('#confirm-pay').hide()
        const payload = {
            _token: "{{ csrf_token() }}",
            name: $('#name').val(),
            password: $('#password').val(),
            email: $('#email').val(),
            region: $('#region').val(),
            comuna: $('#comuna').val(),
            calle_avenida: $('#calle_avenida').val(),
            numero: $('#numero').val(),
            phone: $('#phone').val(),
            dia_visita: $('#dia_visita').val(),
            semana_visita: ( $("#check-sem-1").is(':checked') ) ? $("#check-sem-1").val() :
                           ( $("#check-sem-2").is(':checked') ) ? $("#check-sem-2").val() :
                           ( $("#check-sem-3").is(':checked') ) ? $("#check-sem-3").val() :
                           ( $("#check-sem-4").is(':checked') ) ? $("#check-sem-4").val() :
                           ( $("#check-sem-5").is(':checked') ) ? $("#check-sem-5").val() : '',
            paquete_id: $('#paquete_id').val(),
            kit_id: $('#kit_id').val(),
            kits: plan_suscribe.kitsTotal,
        }

        const validator = ( payload.name === '' || 
                            payload.password === '' || 
                            payload.email === '' || 
                            payload.region === '' || 
                            payload.comuna === '' || 
                            payload.calle_avenida === '' || 
                            payload.numero === '' || 
                            payload.dia_visita === '' || 
                            payload.semana_visita === '' || 
                            payload.paquete_id === '' || 
                            payload.kit_id === '' ) ? false : true
        if(validator){
                           
            $.ajax({
                type: "post",
                url: "/subscribe-payment-charge",
                data:{
                    "_token": "{{ csrf_token() }}",
                    "payload":payload
                },
                success: function (data) {
                    $('#token_ws').val(data.tokenWs);
                    $('#form_pay_wapay').attr("action", data.formAction);
                    $('#load').hide()
                    $('#finish-msg-register').show()
                },
                error: function (data) {
                    console.log('Error:', data);
                }
            });
        }else{
            Swal.fire({
                title: "Alerta!",
                text: "Hay algunos campos vacios!",
                type: "info",
                timer: 3000,
                confirmButtonClass: 'btn btn-primary',
                buttonsStyling: false,
            });
        }
    }
    
</script>
@endsection
